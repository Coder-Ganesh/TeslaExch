if(typeof(ChangeStatusHandler)=="undefined"){ChangeStatusHandler={}}(function(){ChangeStatusHandler.init=function(){PageConfig.changeStatus=-1;JsCache.get("#activeBtn").click(function(){b();c();var d=$j(this);if(d.hasClass("open")){d.removeClass("open");PageConfig.changeStatus=-1}else{if(!$j("#originalStatus").hasClass("status-active")){d.addClass("open");PageConfig.changeStatus=0;JsCache.get("#lockedBtn").removeClass("open");JsCache.get("#suspendBtn").removeClass("open")}}});JsCache.get("#suspendBtn").click(function(){b();c();var d=$j(this);if(d.hasClass("open")){d.removeClass("open");PageConfig.changeStatus=-1}else{if($j("#originalStatus").hasClass("status-active")){d.addClass("open");PageConfig.changeStatus=1;JsCache.get("#lockedBtn").removeClass("open");JsCache.get("#activeBtn").removeClass("open")}}});JsCache.get("#lockedBtn").click(function(){b();c();var d=$j(this);if(d.hasClass("open")){d.removeClass("open");PageConfig.changeStatus=-1}else{if(!$j("#originalStatus").hasClass("status-lock")){d.addClass("open");PageConfig.changeStatus=2;JsCache.get("#activeBtn").removeClass("open");JsCache.get("#suspendBtn").removeClass("open")}}});JsCache.get("#maxLossUnSuspendBtn").click(function(){var d=$j(this);if(d.hasClass("disable")){return}a();c();if(d.hasClass("open")){d.removeClass("open");d.addClass("but_suspend");PageConfig.changeStatus=-1}else{d.addClass("open");PageConfig.changeStatus=3}});JsCache.get("#maxWinUnSuspendBtn").click(function(){var d=$j(this);if(d.hasClass("disable")){return}a();c();if(d.hasClass("open")){d.removeClass("open");d.addClass("but_suspend");PageConfig.changeStatus=-1}else{d.addClass("open");PageConfig.changeStatus=4}});JsCache.get("#unPassLockBtn").click(function(){var d=$j(this);if(d.hasClass("disable")){return}a();b();if(d.hasClass("open")){d.removeClass("open");d.addClass("but_locked");PageConfig.changeStatus=-1}else{d.addClass("open");PageConfig.changeStatus=5}})};ChangeStatusHandler.showDialog=function(g,p,e){PageConfig.changeStatus=-1;var m;if(g>=0){m=IndexHandler.data[g]}else{m=PageConfig.account}var j=$j("#maxWinLossSuspendDiv");var h=$j("#maxWinUnSuspendBtn");var n=$j("#maxLossUnSuspendBtn");var i=$j("#maxWinLossSuspendStatus");i.html("");var q=StatusUtilHandler.isMxWinSuspended(m.isMaxWinSuspended);var f=StatusUtilHandler.isMxLossSuspended(m.isMaxLossSuspended,m.userLevel);if(q||f){if(q){h.removeClass("disable");h.removeClass("open");h.addClass("but_suspend");i.append('<p class="status-suspend"><img src="/images/transparent.gif">'+I18N.get("form.text.agent.maxWinLimit.suspend")+"</p>");$j("#maxWinSuspendInfo").show()}else{h.addClass("disable");h.hide();$j("#maxWinSuspendInfo").hide()}if(f){n.removeClass("disable");n.removeClass("open");n.addClass("but_suspend");i.append('<p class="status-suspend"><img src="/images/transparent.gif">'+I18N.get("form.text.agent.maxLossLimit.suspend")+"</p>");$j("#maxLossSuspendInfo").show()}else{n.addClass("disable");n.hide();$j("#maxLossSuspendInfo").hide()}j.show()}else{h.addClass("disable");n.addClass("disable");j.hide()}var l=$j("#passLockDiv");if(m.isPassLock>0){l.show()}else{l.hide()}var k=$j("#systemLockedMessage");if(m.isSystemLocked>0){k.show()}else{k.hide()}var d=$j("#systemSuspendMessage");if(m.isSystemSuspended>0){d.show()}else{d.hide()}StatusUtilHandler.genAccountHtml(JsCache.get("#changeAccount"),m);StatusUtilHandler.genStatusPopupHtml(JsCache.get("#originalStatus"),m);var o=$j("#originalStatus");if(o.hasClass("status-active")){JsCache.get("#activeBtn").addClass("disable")}else{if(o.hasClass("status-suspend")){JsCache.get("#suspendBtn").addClass("disable")}else{if(o.hasClass("status-lock")){JsCache.get("#lockedBtn").addClass("disable");JsCache.get("#suspendBtn").addClass("disable")}}}JsCache.get("#changeStatusModal").delegate("#changeStatusBtn","click",function(){ChangeStatusHandler.check(g,p,e)});$j(document).bind("keydown",function(r){if(KeyEventUtils.isEnterKey(r.keyCode)){$j("#changeStatusBtn").click()}});JsCache.get("#changeStatusModal").show()};function a(){$j("#activeBtn").removeClass("open");$j("#lockedBtn").removeClass("open");$j("#suspendBtn").removeClass("open")}function b(){$j("#maxWinUnSuspendBtn").removeClass("open");$j("#maxLossUnSuspendBtn").removeClass("open")}function c(){$j("#unPassLockBtn").removeClass("open")}ChangeStatusHandler.hideDialog=function(){JsCache.get("#changeStatusModal").hide();$j(document).unbind("keydown");JsCache.get("#changeStatusModal").undelegate("#changeStatusBtn","click");JsCache.get("#activeBtn").removeClass("open").removeClass("disable");JsCache.get("#lockedBtn").removeClass("open").removeClass("disable");JsCache.get("#suspendBtn").removeClass("open").removeClass("disable");JsCache.get("#changeAccount").text("");JsCache.get("#originalStatus").text("");JsCache.get("#changeStatusPassword").val("");JsCache.get("#changeStatusPassword").removeClass("error")};ChangeStatusHandler.check=function(h,f,d){try{if(PageConfig.changeStatus==-1){throw new NotValidException(I18N.get("msg.error.validation.pleaseSelectAStatus"))}PageConfig.password=$j("#changeStatusPassword").val();if(ValidateDataUtil.isEmpty(PageConfig.password)){JsCache.get("#changeStatusPassword").addClass("error");throw new NotValidException(I18N.get("msg.error.account.passwordEmpty"))}PageConfig.password=EncryptUtil.mask(PageConfig.password);$j.ajax({type:"POST",url:"/agent/memberManagementController/changeStatus",data:{changeStatusPassword:PageConfig.password,userID:f,site:d,status:PageConfig.changeStatus},beforeSend:function(){JsCache.get("#loading").show()},complete:function(){JsCache.get("#loading").hide();PageConfig.password=""},success:function(l){if(l.error!=null){var i;if(l.error[0]=="["){i="";var e=JSON.parse(l.error);for(var j in e){i+=e[j]+"\n"}}else{i=l.error}NoticeHandler.error(i)}else{var k;if(h>=0){k=IndexHandler.data[h];StatusUtilHandler.genStatusHtml($j("#status"+h),l)}else{k=PageConfig.account;StatusUtilHandler.genStatusHtml($j("#account_status"),l)}k.status=l.status;k.isLocked=l.isLocked;k.isSuspended=l.isSuspended;k.isSystemLocked=l.isSystemLocked;k.isSystemSuspended=l.isSystemSuspended;k.isMaxLossSuspended=l.isMaxLossSuspended;k.isMaxWinSuspended=l.isMaxWinSuspended;k.isPassLock=l.isPassLock;ChangeStatusHandler.hideDialog();NoticeHandler.success(I18N.get("msg.executeSuccessful.executeSuccessfully"))}},error:function(j,e,i){Trace.log(j.status);Trace.log(i);return}})}catch(g){JsCache.get("#changeStatusPassword").val("");NoticeHandler.error(g.message)}}})();