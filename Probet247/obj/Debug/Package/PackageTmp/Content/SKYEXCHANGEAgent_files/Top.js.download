if(typeof(AgentTopHandler)=="undefined"){AgentTopHandler={}}(function(){var a=-1;AgentTopHandler.init=function(){LogoutUtilHandler.init();$j("body").prepend("<div style='display: none'><input type='password' autocomplete='new-password'/></div>");JsCache.get("#topRefresh").click(function(b){JsCache.get("#mainBalance").parent().hide();JsCache.get("#topRefreshIcon").show();JsCache.get("#topRefreshIcon").next().hide();AgentTopHandler.queryAgentInfoTask.refresh();setTimeout(function(){JsCache.get("#mainBalance").parent().show();JsCache.get("#topRefreshIcon").hide();JsCache.get("#topRefreshIcon").next().show()},1000)});JsCache.get("#logout").click(function(){try{LogoutUtilHandler.logout()}catch(b){}});AgentTopHandler.queryAgentInfoTask.run();TaskExecuter.execute()};AgentTopHandler.queryAgentInfoTask=TaskExecuter.createTask(5,0,function(){var b=this;AgentTopHandler.queryAgentInfo(b)});AgentTopHandler.queryAgentInfo=function(b){if(b==null){return}$j.ajax({type:"POST",dataType:"JSON",url:"/agent/memberManagementController/querySelfInfo",data:{action:"top"},success:function(d){try{if(d==null){return}if(d.error){Trace.log(d.error)}else{PageConfig.balance=d.balance;CurrencyUtil.updateSetting({currencySymbol:PageConfig.currencySymbol});JsCache.get("#mainBalance").html(PageConfig.CurrencyTypeName+" "+CurrencyUtil.formatter(PageConfig.balance));var c=d.isSuspended;if(PageConfig.ENABLE_SUBACCOUNT_DOWNLINE_VIEW){c=d.isSuspended&&!PageConfig.isSubAccount}if(c){NoticeHandler.error(I18N.get("msg.error.account.isSuspended"))}if(typeof(IndexHandler)!="undefined"&&a!=-1&&a!=d.isSuspended){IndexHandler.listMember()}a=d.isSuspended}}catch(f){Trace.printStackTrace(f)}finally{b.check();TaskExecuter.execute()}},error:function(e,c,d){Trace.log(e.status);Trace.log(d);b.check();TaskExecuter.execute()}})}})();